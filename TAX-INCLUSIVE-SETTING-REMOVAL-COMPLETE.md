# 税込/税抜き表示設定削除完了

## 概要
管理画面のKantanPro一般設定から「税込/税抜き表示」の設定を廃止しました。これは顧客の税区分によって自動で選択されるようになったため、手動設定が不要になったためです。

## 実施日
2025年1月31日

## 変更内容

### 1. 設定画面からの削除
- `includes/class-ktp-settings.php`から以下を削除：
  - 税込/税抜き表示設定フィールドの登録
  - `get_tax_inclusive()`メソッド
  - `tax_inclusive_callback()`メソッド

### 2. マイグレーションファイルの更新
- `includes/migrations/20250131_add_tax_rate_columns.php`から以下を削除：
  - `tax_inclusive`設定の追加処理
  - `tax_inclusive`設定の削除処理

### 3. 新しいマイグレーションファイルの作成
- `includes/migrations/20250131_remove_tax_inclusive_setting.php`を新規作成
  - 既存の`tax_inclusive`設定を削除するマイグレーション
  - ロールバック機能付き

### 4. マイグレーション実行スクリプトの作成
- `run_remove_tax_inclusive_migration.php`を新規作成
  - マイグレーションを実行するためのCLIスクリプト

## 実行手順

### 1. マイグレーションの実行
```bash
php run_remove_tax_inclusive_migration.php
```

### 2. 確認事項
- 管理画面のKantanPro > 一般設定から「税込/税抜き表示」の設定が削除されていることを確認
- 既存の設定値がデータベースから削除されていることを確認

## 影響範囲

### 削除された機能
- 管理画面での税込/税抜き表示の手動設定
- `KTP_Settings::get_tax_inclusive()`メソッド

### 影響なし
- 顧客の税区分による自動表示機能（内税/外税）
- その他の税関連設定（基本税率、軽減税率など）

## 後方互換性
- 既存のコードで`get_tax_inclusive()`メソッドを呼び出している場合は、エラーが発生する可能性があります
- 該当箇所があれば、顧客の税区分を直接取得するように修正が必要です

## ロールバック方法
必要に応じて、以下のコマンドでロールバック可能です：

```php
// マイグレーションファイル内のdown()メソッドを実行
KTPWP_Migration_20250131_Remove_Tax_Inclusive_Setting::down();
```

## 備考
- この変更により、税表示は顧客の税区分（内税/外税）に基づいて自動的に決定されます
- 手動設定が不要になり、より一貫性のある表示が可能になりました
- 設定画面がよりシンプルになり、ユーザビリティが向上しました 